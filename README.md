# 敷地図PDFエディタ

建築計画用の敷地図に建物を配置するためのWebアプリケーションです。日本の建築基準に基づいた制約を考慮しながら、住宅や集合住宅を効率的に配置できます。

## 機能

- **PDFファイルの読み込み**: 敷地図のPDFを背景として表示
- **4種類の建物タイプ**: 戸建住宅2種類、サ高住、集合住宅
- **3つの配置モード**: 選択、単体配置、エリア配置
- **910mmグリッドシステム**: 日本の建築モジュールに準拠
- **自動配置制約**: 建物間の必要間隔を自動計算
- **データ出力**: JSON形式でのデータエクスポート

### 新機能（2025年1月更新）
- **同一建物ペア配置**: 建物A・Bを入口と反対側で密着配置（2棟セット）
- **箱のみ表示モード**: 入口マーカーを非表示にして長方形のみで配置
- **カラー/白黒切替**: 建物タイプごとにカラー表示と白黒表示を切り替え可能

## 使い方

### 起動方法
1. `index.html`をWebブラウザで開く（Chrome推奨）
2. インターネット接続が必要（CDNからライブラリを読み込むため）

### 基本操作

#### 1. PDF背景の設定
- 「PDFファイルを選択」ボタンから敷地図のPDFを読み込み

#### 2. 建物の配置
**配置モード（Placeモード）**
- 建物タイプを選択
- キャンバス上でクリックして配置
- 910mm単位でグリッドにスナップ

**エリアモード（Areaモード）**
- 建物タイプを選択
- ドラッグして範囲を指定
- 範囲内に可能な限り建物を自動配置
- 短辺方向、長辺方向どちらも間隔は0〜5mで調整可能（デフォルト1.2m）

#### 3. 建物の選択・移動
**選択モード（Selectモード）**
- 建物をクリックして選択
- ドラッグで移動（グリッドにスナップ）
- Deleteキーで削除

#### 4. 配置オプション
**同一建物ペア配置**
- 「同一建物ペア配置（上下密着）」にチェック
- 建物AまたはBを選択して配置すると、同じタイプの建物が2つ密着して配置
- 入口と反対側（上側の短辺）で密着

**箱のみ表示**
- 「箱のみ表示（入口なし）」にチェック
- 建物A・Bの入口マーカー（赤線）を非表示
- シンプルな長方形として配置

**カラー/白黒切替**
- 各建物タイプの「カラー表示」チェックボックスで切り替え
- チェックOFF時は白黒（グレー）表示
- 既存の建物も動的に更新

## 建物仕様

### PLAN-① (戸建住宅A)
- サイズ: 6.37m × 8.19m
- 玄関: 下側（赤線表示）
- 短辺側: テラス(0.91m)、玄関、ポーチ(1.2m)付き

### PLAN-② (戸建住宅B)
- サイズ: 5.46m × 7.28m
- 玄関: 下側（赤線表示）
- 短辺側: テラス(0.91m)、玄関、ポーチ(1.2m)付き

### 建物C (サ高住)
- サイズ: 42m × 43m
- 短辺側: 適切な間隔が必要

### 建物D (集合住宅)
- サイズ: 19.5m × 34.2m
- 短辺側: 適切な間隔が必要

## 配置ルール

1. **短辺側**: テラス(0.91m)、玄関、ポーチ(1.2m)があるため間隔が必要
2. **長辺側**: 隣接配置可能
3. **グリッドスナップ**: 全ての建物は910mmグリッドに整列

## 技術仕様

- **スケール**: 1/1000（1m = 4ピクセル）
- **キャンバスサイズ**: 1200×850ピクセル（300m×212.5m相当）
- **グリッド**: 910mm単位（3.64ピクセル）

## ファイル構成

```
site-map-editor/
├── index.html          # メインHTMLファイル
├── css/
│   └── styles.css     # スタイルシート
├── js/
│   ├── config.js      # 設定ファイル（建物タイプ・定数定義）
│   ├── main.js        # メインアプリケーション（初期化・イベント処理）
│   ├── canvas.js      # キャンバス関連機能（グリッド・PDF処理）
│   ├── building.js    # 建物配置ロジック
│   └── utils.js       # ユーティリティ関数（削除・回転・エクスポート）
├── README.md          # このファイル
└── CLAUDE.md          # 開発者向けドキュメント
```

## 使用ライブラリ

- [Fabric.js](http://fabricjs.com/) v5.3.0 - キャンバス操作
- [PDF.js](https://mozilla.github.io/pdf.js/) v3.11.174 - PDF表示

## 動作環境

- モダンブラウザ（Chrome, Firefox, Safari, Edge）
- インターネット接続（CDN利用のため）

## 注意事項

- 実際の建築計画では、この配置図を参考に専門家による詳細な検討が必要です
- 建築基準法や各自治体の条例に従って計画してください